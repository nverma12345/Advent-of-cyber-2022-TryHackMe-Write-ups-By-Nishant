Welcome to Day 2 of Advent of Cyber 4 (2022) write-up. To check the room, [click here](https://tryhackme.com/room/adventofcyber4).

![](https://miro.medium.com/max/875/1*WxOHmYXivCklJGSUkcVhiA.png)

# [Day 2] Log Analysis Santa’s Naughty & Nice Log

Day 2 covers the concept of logging and log analysis. Today we will discuss various log files in Windows and Linux. We will also cover a few tools and methods to analyze logs to solve the challenge.

# Learning Objectives

In today’s task, you will:

-   Learn what log files are and why they’re useful
-   Understand what valuable information log files can contain
-   Understand some common locations these logs file can be found
-   Use some basic Linux commands to start analyzing log files for helpful information
-   Help Elf McBlue track down the Bandit Yeti APT!

# What Are Log Files and Why Are They Useful

Log files contain historical records of events and other data from an application. Some common examples of events that you may find in a log file:

-   Login attempts or failures
-   Traffic on a network
-   Things (website URLs, files, etc.) that have been accessed
-   Password changes
-   Application errors (used in debugging)
-   _and many, many more_

By making a historical record of events that have happened, log files are critical pieces of evidence when investigating:

-   What has happened?
-   When has it happened?
-   Where has it happened?
-   Who did it? Were they successful?
-   What is the result of this action?

# Grep 101

_Grep_ is a command that searches for a given text in a file. _Grep_ takes a given input (a text or value) and explores the entire file for any text that matches our input.

## Command:

grep (string to find)

![](https://miro.medium.com/max/875/1*Jzjb5tvrLk46NFzzJPz0wg.png)

Grep options

If you want to read further, you can refer to [Day 2 of Advent of Cyber 4.](https://tryhackme.com/room/adventofcyber4)

Let’s get started!

1.  Ensure you are connected to the deployable machine in this task.

Click on the “Start Machine” button and then click “Show Split Screen.”

![](https://miro.medium.com/max/875/1*pi-TC8nS0VhNdUh603HvKg.png)

Answer: No answer needed

2. Use the ls command to list the files present in the current directory. How many log files are present.

Enter the _ls_ command, and you will see two log files.

![](https://miro.medium.com/max/833/1*n-4tKhE11cO73yKVkRTpIw.png)

Answer: 2

3. Elf McSkidy managed to capture the logs generated by the web server. What is the name of this log file?

From the previous output, we learned that a web server generates webserver.log.

![](https://miro.medium.com/max/581/1*9zl5QnZTXSXu7pgBTKaBMg.png)

Answer: webserver.log

4. Begin investigating the log file from question #3 to answer the following questions.

Answer: No answer needed

5. On what day was Santa’s naughty and nice list stolen?

Using the following command:

grep -i -r "santa" webserver.log

You’ve found that using a GET request; the santaslist.txt was fetched on 18/Nov/2022. By checking the calendar, you can see that this occurred on Friday.

![](https://miro.medium.com/max/875/1*B94SY3dyXxO-kLIRtzWVGQ.png)

Answer: Friday

6. What is the IP address of the attacker?

The previous output shows that GET requests for the santaslist.txt occurred using the 10.10.249.191 IP address.

![](https://miro.medium.com/max/875/1*Z47NtaZM6ygDV36df8iAMQ.png)

Answer: 10.10.249.191

7. What is the name of the important list that the attacker stole from Santa?

![](https://miro.medium.com/max/875/1*RDAhBlUiwyG-AQQyjprUlw.png)

Answer: santaslist.txt

8. Look through the log files for the flag. The format of the flag is: THM{}

Using the following command:

grep -r "THM”

![](https://miro.medium.com/max/875/1*UDEEQScK4AXzpMr-0oCVJw.png)

Answer: THM{STOLENSANTASLIST}

9. Interested in log analysis? We recommend the [Windows Event Logs](https://tryhackme.com/room/windowseventlogs) room or the [Endpoint Security Monitoring Module](https://tryhackme.com/module/endpoint-security-monitoring).

Answer: No answer needed

# Closure

This task covered the basics of logging and different log files. We also discussed Grep, which is beneficial for logging and making our work easier. We got to know using logging, and we can analyze the incidents and events in a system.

![](https://miro.medium.com/max/613/1*Q2XCMhrvSJp3OB3sEPqAyQ.jpeg)

Well done!  

> Follow me on LinkedIn: [https://www.linkedin.com/in/nishantverma123/](https://www.linkedin.com/in/nishantverma123/)

Thank you for reading.